DELIMITER $$

CREATE PROCEDURE Posting(
   IN p_title VARCHAR(255),
   IN p_content TEXT,
   IN p_user_id INT
)
BEGIN
   IF p_title IS NULL OR p_title = '' THEN
      SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Error: 제목은 필수입니다.';
   END IF;

   IF p_content IS NULL OR p_content = '' THEN
      SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Error: 내용은 필수입니다.';
   END IF;

   IF NOT EXISTS (SELECT 1 FROM `User` WHERE user_id = p_user_id) THEN
      SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Error: 유효하지 않은 작성자입니다.';
   END IF;

   INSERT INTO community (title, content, user_id)
   VALUES (p_title, p_content, p_user_id);
END $$

DELIMITER ;


CALL Posting('testtest', 'dd', 1);
